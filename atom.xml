<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Lucas' Thoughts]]></title>
  <link href="http://muzzlefork.github.com/atom.xml" rel="self"/>
  <link href="http://muzzlefork.github.com/"/>
  <updated>2012-11-02T23:00:01+11:00</updated>
  <id>http://muzzlefork.github.com/</id>
  <author>
    <name><![CDATA[MuzzleFork]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[MySQL Performance on OS X]]></title>
    <link href="http://muzzlefork.github.com/blog/2012/01/mysql-performance-on-os-x/"/>
    <updated>2012-01-25T22:50:00+11:00</updated>
    <id>http://muzzlefork.github.com/blog/2012/01/mysql-performance-on-os-x</id>
    <content type="html"><![CDATA[<p>Ever wondered why performance of MySQL on OS X was so much worse than a Linux or windows counterpart - especially when doing DROP/CREATE statements (ie in the setup of unit tests etc)? It turns out Mac OS has a safer file creation function than is available on other operating systems and the use of that slows down performance of file operations in MySQL.</p>

<p>You can fix this quickly by adding the following to your <strong>my.cnf</strong> file in the<strong> [server]</strong> block. It&#8217;s probably best not to do this in production, but who actually uses OS X as a production web server anyway?</p>

<pre>skip-sync-frm=OFF</pre>


<p>Source: <a href="http://bugs.mysql.com/bug.php?id=56550">The original MySQL bug report</a> (although it&#8217;s not really a bug).</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Problems with the default virtual host on MAMP Pro 2.0.5]]></title>
    <link href="http://muzzlefork.github.com/blog/2012/01/problems-with-the-default-virtual-host-on-mamp-pro-2-dot-0-5/"/>
    <updated>2012-01-23T00:00:00+11:00</updated>
    <id>http://muzzlefork.github.com/blog/2012/01/problems-with-the-default-virtual-host-on-mamp-pro-2-dot-0-5</id>
    <content type="html"><![CDATA[<p>I&#8217;ve recently upgraded to MAMP Pro and I like how I can easily add virtual hosts in its UI - something I had previously done in code in the free version and on older machines running windows, Linux etc. I ran into a strange problem with MAMP though.</p>

<p>In the project I&#8217;m working on, I expect to have the default behaviour for unmatched host names go to the first virtual host (a default behaviour of the apache virtual host system) and to have some custom virtual host configurations for my Zend Framework app to work (namely &#8220;SetEnv APPLICATION_ENV development&#8221;). After pulling my hair out for a while, I found out why my environment variables weren&#8217;t being sent through to apache and PHP when I was getting the default virtual host: MAMP Pro adds an extra first virtual host above your collection of virtual hosts (trying to be helpful, I assume) which doesn&#8217;t have the custom virtual host directory settings in it and as such, requests will fail.<!--more--></p>

<p>To fix it, go to</p>

<p><img src="http://muzzlefork.github.com/images/mamp-edit-conf.png" width="546" height="110"></p>

<p>and make the following change:</p>

<script src="https://gist.github.com/3060058.js"> </script>


<p>Of note here are the commented out lines. This port iteration business sets up an empty virtual host at the start of the list which is responsible for handling all failed matches of the following entries - AKA the default virtual host. In my version of the file, this is around line 570, but you should see it about 60 lines before the end of the file.</p>

<p>Then restart apache. You&#8217;ll find in your compiled httpd.conf file (/Library/Application Support/appsolute/MAMP PRO/conf/httpd.conf), you no longer have the extra virtual host definition above the ones you&#8217;ve explicitly defined and the extra settings you&#8217;ve added into the definition for your first virtual host will be passed along correctly to all unmatched web requests.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Stop working on shit code]]></title>
    <link href="http://muzzlefork.github.com/blog/2011/07/stop-working-on-shit-code/"/>
    <updated>2011-07-26T00:00:00+10:00</updated>
    <id>http://muzzlefork.github.com/blog/2011/07/stop-working-on-shit-code</id>
    <content type="html"><![CDATA[<p>Do you work on old, shitty code? Does it stink? Each time you have to work on that same file that drives you nuts, does it make you question your sanity?</p>

<p>In my day job, if there&#8217;s something that&#8217;ll bring tears to a developer&#8217;s eyes, it&#8217;s being given a story to work on that involves touching a 6~7 year old file called <code>sales.php</code>. This file is a monstrous 7000+ lines long and is a gigantic state machine that is confusing and highly prone to malfunction. It also loosely forms the &#8220;C&#8221; and the &#8220;V&#8221; of a fairly broken MVC structure. To make matters worse, over the years, there have been ~10 different developers &#8216;work&#8217; on it and it&#8217;s a delicate debacle of different coding styles, motivations and business desires.<!--more--></p>

<p>Every developer who has ever had the misfortune of working with this file (and the rest of the broken MVC) has always cried out that the whole system needs rewriting (and rightly so), but it&#8217;s hard to sell that to the business when it&#8217;ll a) take ages, b) probably take longer than that, c) in the meantime, they get no new features and d) will, once completed, probably be just as bad as the old one (and hey presto, it&#8217;s now outdated too). I was talking to a colleague about this the other week and came to a realisation about it.</p>

<p><strong>Stop working on shit code! We&#8217;re better than that.</strong> After working with this software for 3 years, I can&#8217;t say that I&#8217;m proud of the work I&#8217;ve done there (my colleague was 6 years - he couldn&#8217;t either) - I&#8217;ve just continued the legacy of bad code because the barrier to change was too high. If you can&#8217;t be proud of your work, then when you look back on it later, you&#8217;ll realise you&#8217;ve wasted your time (and your company&#8217;s). As of that day, my new work ethos is centred around pride.</p>

<ul>
    <li>As I commit each changeset, I want to be able to say I&#8217;m proud of the code I&#8217;m committing.</li>
    <li>I respect my colleagues as professionals and friends. When they peer review my work, I don&#8217;t want them to think &#8220;Wow, what a lame way to do that&#8221; or &#8220;wouldn&#8217;t it be great if he did &#8216;xyz&#8217;?&#8221;. If they do think I&#8217;ve done something poorly, I <strong>want</strong> them to call me out on it. If they know some smarter way to do it, teach me. If I&#8217;ve left a debugging line in or a dodgy comment, make me fix it.</li>
    <li>Conversely, when I peer review my colleague&#8217;s work, I want to know that what I&#8217;m seeing is their best solution to the problem and that they are proud of the work they&#8217;re showing me. I will tell them if I think it stinks and explain why.</li>
</ul>


<p>I&#8217;m not saying each commit has to revolutionise the world or rewrite the whole system, but <strong>the state of the system should &#8216;smell&#8217; better after each commit than before.</strong> Not smell the same, and definitely not smell worse. Working on some new calculation inside a 7000 line class? Refactor that calculation out in a sensible way. Suddenly that stinky old class is only 6900 lines of crap. I&#8217;d say that smells a little better.</p>

<p>Go home at the end of the day being able to say &#8221;<strong>I&#8217;m proud of what I did here</strong>&#8221;.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[OS X Lion + MAMP 2.0.1 + Memcache and PHP 5.2.17]]></title>
    <link href="http://muzzlefork.github.com/blog/2011/07/os-x-lion-mamp-2-0-1-memcache-and-php-5-2-17/"/>
    <updated>2011-07-25T00:00:00+10:00</updated>
    <id>http://muzzlefork.github.com/blog/2011/07/os-x-lion-mamp-2-0-1-memcache-and-php-5-2-17</id>
    <content type="html"><![CDATA[<p>After a fresh install of Lion, getting up to speed with my normal MAMP dev setup + memcached wasn&#8217;t as easy as on Snow Leopard. I ended up seeking inspiration from the following articles:</p>

<ul>
    <li><a href="http://mxcl.github.com/homebrew/">Homebrew</a> - for installing memcached</li>
    <li><a href="http://www.lullabot.com/articles/setup-memcached-mamp-sandbox-environment">Lullabot&#8217;s article about memcached with mamp</a></li>
    <li><a href="http://forum.mamp.info/viewtopic.php?f=2&amp;t=13815">MAMP Forum</a> - MAMP 2.0.1&#8217;s pear is broken</li>
</ul>


<p>In hindsight, it was quite easy:<!--more--></p>

<ul>
    <li>Ensure Xcode is installed - XCode 4.1 is free now in the app store - make sure you install it after it downloads</li>
    <li>Install homebrew as per the instructions <a href="http://mxcl.github.com/homebrew/">here</a></li>
    <li>Install memcached by simply
<code>brew install memcached</code></li>
    <li>pear in this version of MAMP is broken, to fix it, simply remove pear&#8217;s config file
<code>mv /Applications/MAMP/bin/php/php5.2.17/conf/pear.conf /Applications/MAMP/bin/php/php5.2.17/conf/pear.conf.old</code></li>
    <li>As per the section &#8221;<a href="http://www.lullabot.com/articles/setup-memcached-mamp-sandbox-environment">Install Memcache PHP Extension - Option 2</a>&#8221;
<ul>
    <li><a href="http://www.php.net/downloads.php">Download the correct version of the php source code for your installed php</a></li>
    <li>Create the path /Applications/MAMP/bin/php/php5.2.17/include/ and extract the contents of the source code download here.</li>
    <li>Rename the folder that was created as just &#8216;php&#8217; so you&#8217;ll end up with /Applications/MAMP/bin/php/php5.2.17/include/php</li>
    <li><code>cd /Applications/MAMP/bin/php/php5.2.17/include/php
./configure
cd /Applications/MAMP/bin/php/php5.2.17/bin
./pecl i memcache</code>
This should dump memcached.so in the extension folder. If it&#8217;s made something other than /Applications/MAMP/bin/php/php5.2.17/lib/php/extensions/no-debug-non-zts-20060613, move it into there (it&#8217;d only be different in the last part of the path)</li>
</ul>
</li>
    <li>Add this to the extensions part of your php.ini
<code>
extension=memcache.so
</code></li>
    <li>Restart apache</li>
</ul>


<p>And hey presto, it&#8217;s done.</p>

<p>You could also cheat and just put my <a href="http://muzzlefork.github.com/wp-content/uploads/2011/07/memcache.so">pre-compiled version of memcache.so</a> in your extension folder and go to town.</p>

<p><span style="text-decoration: underline;">Update:</span>
I&#8217;ve also compiled the php 5.3.6 version of the <code>.so</code> file. <a href="http://muzzlefork.github.com/wp-content/uploads/2011/07/memcache-php5.3.6.so">Download it</a>, rename it back to <code>memcache.so</code>, put it in your extension folder and enjoy.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Wiki Class]]></title>
    <link href="http://muzzlefork.github.com/blog/2010/06/wiki-class/"/>
    <updated>2010-06-08T21:44:00+10:00</updated>
    <id>http://muzzlefork.github.com/blog/2010/06/wiki-class</id>
    <content type="html"><![CDATA[<p>Ages ago, I wrote a simple class to enable some scripts to update our wiki. A friend asked for a copy, so here it is:<!--more--></p>

<div><script src='https://gist.github.com/1598093.js?file='></script>
<noscript><pre><code>&lt;?php
$wiki = new wiki('http://mywikiurl.com/api.php');
$wiki-&gt;edit('pageName', 'contents');
?&gt;</code></pre></noscript></div>



]]></content>
  </entry>
  
</feed>
